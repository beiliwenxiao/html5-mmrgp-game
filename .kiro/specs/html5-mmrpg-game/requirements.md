# 需求文档

## 简介

本项目旨在开发一个基于HTML5的即时战斗MMRPG（大型多人在线角色扮演游戏）。游戏将在浏览器中运行，通过WebSocket与后端服务器通信。初期阶段将专注于前端实现，使用模拟数据进行开发和测试。

## 术语表

- **游戏客户端 (Game Client)**: 运行在浏览器中的HTML5应用程序，负责渲染游戏画面和处理用户输入
- **战斗系统 (Combat System)**: 处理角色战斗逻辑的游戏子系统，包括攻击、技能释放和伤害计算。因为是即时战斗，所以需要考虑帧同步和网络延迟。同时，需要考虑技能效果的计算和技能效果的触发。同时，要考虑攻击和技能的距离关系。如果有碰撞的物理引擎更好。

- **角色 (Character)**: 玩家控制的游戏实体，具有属性、技能和装备。
开战状态下，玩家不能控制装备。
开战状态下，玩家可以控制三个技能。
装备损毁后，角色将无法使用技能。对应的装备属性也会下降。
玩家在离开战斗1分钟后，回到离开战斗的状态。
玩家在死亡时，进入到离开战斗的装备，并且在1分钟后从复活点复活。

- **技能 (Skill)**: 角色可以释放的特殊能力，具有冷却时间和效果
- **模拟数据 (Mock Data)**: 用于前端开发的虚拟游戏数据，模拟后端响应
- **游戏场景 (Game Scene)**: 游戏中的不同界面状态，如登录界面、角色选择、战斗场景等
- **WebSocket连接 (WebSocket Connection)**: 客户端与服务器之间的双向通信通道

## 需求

### 需求 1: 游戏客户端初始化

**用户故事:** 作为玩家，我希望能够在浏览器中加载游戏，以便开始游戏体验

#### 验收标准

1. 当浏览器加载游戏页面时，游戏客户端应当初始化HTML5 Canvas渲染环境
2. 当游戏客户端初始化完成时，游戏客户端应当显示加载进度指示器
3. 当所有游戏资源加载完成时，游戏客户端应当显示主菜单界面
4. 当游戏客户端检测到浏览器不支持必需功能时，游戏客户端应当显示错误提示信息

### 需求 2: 角色创建和选择

**用户故事:** 作为玩家，我希望能够创建和选择角色，以便进入游戏世界

#### 验收标准

1. 当玩家点击"创建角色"按钮时，游戏客户端应当显示角色创建界面
2. 当玩家输入角色名称并选择职业时，游戏客户端应当验证输入的有效性
3. 当玩家确认创建角色时，游戏客户端应当使用模拟数据生成角色实例
4. 当玩家在角色选择界面选择已有角色时，游戏客户端应当加载该角色的模拟数据
5. 当角色数据加载完成时，游戏客户端应当切换到游戏主场景

### 需求 3: 游戏场景渲染

**用户故事:** 作为玩家，我希望看到流畅的游戏画面，以便获得良好的视觉体验

#### 验收标准

1. 游戏客户端应当以每秒60帧的速率渲染游戏画面
2. 当角色在场景中移动时，游戏客户端应当平滑更新角色位置
3. 当场景中存在多个角色时，游戏客户端应当正确渲染所有可见角色
4. 当游戏窗口大小改变时，游戏客户端应当调整Canvas尺寸并重新渲染场景
5. 游戏客户端应当渲染游戏UI元素，包括生命值条、技能栏和小地图

### 需求 4: 角色移动控制

**用户故事:** 作为玩家，我希望能够控制角色移动，以便在游戏世界中探索

#### 验收标准

1. 当玩家按下WASD键或方向键时，游戏客户端应当移动角色到相应方向
2. 当玩家点击场景中的位置时，游戏客户端应当计算路径并移动角色到目标位置
3. 当角色移动时，游戏客户端应当播放相应的移动动画
4. 当角色遇到障碍物时，游戏客户端应当阻止角色穿过障碍物
5. 当角色移动超出当前视野范围时，游戏客户端应当平滑滚动摄像机跟随角色

### 需求 5: 即时战斗系统

**用户故事:** 作为玩家，我希望能够与敌人进行即时战斗，以便体验刺激的战斗玩法

#### 验收标准

1. 当玩家点击敌人时，游戏客户端应当将该敌人设为攻击目标
2. 当角色在攻击范围内且攻击冷却完成时，游戏客户端应当自动执行普通攻击
3. 当玩家按下技能快捷键时，游戏客户端应当释放对应技能并触发技能效果
4. 当技能处于冷却状态时，游戏客户端应当禁用该技能按钮并显示剩余冷却时间
5. 当角色或敌人受到伤害时，游戏客户端应当显示伤害数字并更新生命值
6. 当角色或敌人生命值降至零时，游戏客户端应当播放死亡动画并移除该实体

### 需求 6: 技能系统

**用户故事:** 作为玩家，我希望能够使用多种技能，以便采用不同的战斗策略

#### 验收标准

1. 游戏客户端应当为每个角色加载技能列表从模拟数据
2. 当玩家释放技能时，游戏客户端应当验证技能释放条件（冷却时间、魔法值等）
3. 当技能释放成功时，游戏客户端应当播放技能动画和音效
4. 当技能命中目标时，游戏客户端应当根据模拟数据计算并应用技能效果
5. 当技能进入冷却时，游戏客户端应当启动冷却计时器并更新UI显示

### 需求 7: 用户界面

**用户故事:** 作为玩家，我希望有清晰的用户界面，以便了解角色状态和游戏信息

#### 验收标准

1. 游戏客户端应当在屏幕上方显示角色生命值和魔法值条
2. 游戏客户端应当在屏幕下方显示技能栏，包含所有可用技能
3. 当玩家选中目标时，游戏客户端应当显示目标的生命值条和名称
4. 游戏客户端应当在屏幕角落显示小地图，标示角色和敌人位置
5. 当角色获得经验值或升级时，游戏客户端应当显示通知消息

### 需求 8: 模拟数据管理

**用户故事:** 作为开发者，我希望使用模拟数据进行前端开发，以便在后端未完成时继续开发

#### 验收标准

1. 游戏客户端应当包含模拟数据模块，提供角色、敌人和技能数据
2. 当游戏需要服务器数据时，游戏客户端应当从模拟数据模块获取数据
3. 游戏客户端应当模拟WebSocket消息格式，确保与未来后端接口兼容
4. 游戏客户端应当提供配置选项，在模拟模式和真实服务器模式之间切换
5. 当使用模拟数据时，游戏客户端应当在控制台输出调试信息

### 需求 9: 动画和特效

**用户故事:** 作为玩家，我希望看到精美的动画和特效，以便获得沉浸式的游戏体验

#### 验收标准

1. 当角色执行动作时，游戏客户端应当播放相应的精灵动画
2. 当技能释放时，游戏客户端应当显示粒子特效
3. 当角色受到伤害时，游戏客户端应当播放受击闪烁效果
4. 游戏客户端应当为UI元素添加过渡动画效果
5. 当重要事件发生时，游戏客户端应当播放屏幕震动效果

### 需求 10: 性能优化

**用户故事:** 作为玩家，我希望游戏运行流畅，以便在各种设备上都能正常游玩

#### 验收标准

1. 游戏客户端应当维持稳定的帧率，在标准硬件上达到60FPS
2. 当场景中实体数量超过阈值时，游戏客户端应当仅渲染视野范围内的实体
3. 游戏客户端应当使用对象池技术管理频繁创建和销毁的对象
4. 游戏客户端应当压缩和优化游戏资源，减少加载时间
5. 当检测到性能问题时，游戏客户端应当自动降低图形质量设置
