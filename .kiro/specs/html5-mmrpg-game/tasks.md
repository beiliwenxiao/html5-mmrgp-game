# 实现计划

- [x] 1. 搭建项目基础结构





  - 创建HTML5项目目录结构（src、assets、styles）
  - 创建index.html主页面，包含Canvas元素和基础样式
  - 创建主入口文件main.js/ts，初始化游戏引擎
  - 配置TypeScript（如使用）或ES6模块
  - _需求: 1.1, 1.2_

- [x] 2. 实现游戏引擎核心





  - [x] 2.1 创建GameEngine类


    - 实现Canvas初始化和上下文获取
    - 实现游戏循环（requestAnimationFrame，60 FPS）
    - 实现update和render方法框架
    - 实现窗口resize处理和Canvas自适应
    - _需求: 1.1, 1.4, 3.1, 3.4_
  
  - [x] 2.2 实现资源管理器AssetManager


    - 创建资源加载队列和缓存系统
    - 实现图片资源异步加载
    - 实现加载进度跟踪
    - 创建基础的精灵图集数据结构
    - _需求: 1.2, 1.3_
  
  - [x] 2.3 实现输入管理器InputManager


    - 监听键盘事件（WASD、方向键、数字键1-6）
    - 监听鼠标事件（点击、移动）
    - 实现输入状态缓存（按键是否按下）
    - 实现Canvas坐标转换（屏幕坐标到游戏世界坐标）
    - _需求: 4.1, 4.2, 5.3_
- [x] 3. 实现场景管理系统


- [ ] 3. 实现场景管理系统

  - [x] 3.1 创建场景基类和管理器


    - 创建Scene基类，定义enter、update、render、exit方法
    - 实现SceneManager，管理场景注册和切换
    - 实现场景转场效果（淡入淡出）
    - _需求: 1.3, 2.5_
  
  - [x] 3.2 实现登录场景LoginScene


    - 创建登录界面UI（标题、开始按钮）
    - 实现开始按钮点击事件，切换到角色选择场景
    - _需求: 1.3, 2.1_
  
  - [x] 3.3 实现角色选择场景CharacterScene


    - 创建角色创建界面（输入框、职业选择）
    - 实现输入验证（角色名称长度、特殊字符）
    - 使用模拟数据创建角色实例
    - 实现角色列表显示和选择功能
    - 切换到游戏主场景并传递角色数据
    - _需求: 2.1, 2.2, 2.3, 2.4, 2.5_

- [x] 4. 实现模拟数据服务



  - [x] 4.1 创建MockDataService类


    - 定义角色模板数据（战士、法师、弓箭手）
    - 定义敌人模板数据（史莱姆、哥布林、骷髅）
    - 定义技能数据（普通攻击、职业技能）
    - 定义地图数据（简单的测试地图）
    - _需求: 8.1, 8.2_
  
  - [x] 4.2 实现模拟WebSocket消息


    - 创建消息格式定义（type、data、timestamp）
    - 实现模拟延迟（setTimeout模拟网络延迟）
    - 实现消息队列和回调机制
    - 创建配置开关（模拟模式/真实服务器模式）
    - _需求: 8.3, 8.4, 8.5_

- [x] 5. 实现实体组件系统（ECS）






  - [x] 5.1 创建实体和组件基础结构

    - 创建Entity类，管理组件集合
    - 创建Component接口
    - 实现TransformComponent（位置、旋转、缩放）
    - 实现StatsComponent（生命值、魔法值、属性）
    - 实现SpriteComponent（精灵图、动画状态）
    - _需求: 3.2, 3.3, 3.5_
  
  - [x] 5.2 创建战斗和移动组件




    - 实现CombatComponent（目标、攻击范围、冷却、技能列表）
    - 实现MovementComponent（速度、路径、移动状态）
    - _需求: 4.1, 4.2, 5.1, 5.2_
  
  - [x] 5.3 实现实体工厂


    - 创建EntityFactory，根据模板数据创建实体
    - 实现createPlayer方法
    - 实现createEnemy方法
    - _需求: 2.3, 2.4_

- [x] 6. 实现渲染系统




  - [x] 6.1 创建基础渲染系统RenderSystem


    - 实现相机Camera类（位置、视野范围）
    - 实现视锥剔除（只渲染可见实体）
    - 实现实体按Y坐标排序（深度效果）
    - 实现背景、实体、UI分层渲染
    - _需求: 3.1, 3.2, 3.3, 3.4_
  
  - [x] 6.2 实现精灵渲染器SpriteRenderer


    - 实现精灵图绘制（drawImage）
    - 实现精灵翻转（面向方向）
    - 实现简单的调试绘制（碰撞盒、坐标）
    - _需求: 3.2, 3.3_
  
  - [x] 6.3 实现动画管理器AnimationManager


    - 创建Animation数据结构（帧序列、帧率、循环）
    - 实现动画播放逻辑（帧更新、循环控制）
    - 实现动画状态机（idle、walk、attack、skill、hit、death）
    - 为角色和敌人添加基础动画（使用占位符精灵）
    - _需求: 4.3, 9.1_

- [x] 7. 实现移动系统




  - [x] 7.1 实现键盘移动



    - 创建MovementSystem类
    - 实现WASD/方向键输入处理
    - 实现速度计算和位置更新
    - 实现移动动画切换
    - _需求: 4.1, 4.3_
  


  - [x] 7.2 实现点击移动






















    - 实现鼠标点击位置获取
    - 实现简单的直线路径移动（暂不实现A*寻路）
    - 实现路径跟随逻辑
    - 实现到达目标点停止


    - _需求: 4.2, 4.3_
  

  - [x] 7.3 实现碰撞检测














    - 创建简单的AABB碰撞检测函数
    - 实现地图边界检测


    - 实现障碍物碰撞检测（使用地图碰撞层）
    - 阻止角色穿过障碍物
    - _需求: 4.4_
  
  - [x] 7.4 实现相机跟随





    - 实现相机平滑跟随玩家
    - 实现相机边界限制（不超出地图范围）
    - _需求: 4.5_

- [x] 8. 实现战斗系统



  - [x] 8.1 实现目标选择


    - 创建CombatSystem类
    - 实现鼠标点击敌人选中逻辑
    - 实现目标高亮显示
    - 实现目标框架UI显示
    - _需求: 5.1, 7.3_
  
  - [x] 8.2 实现普通攻击


    - 实现攻击范围检测
    - 实现攻击冷却计时器
    - 实现自动攻击逻辑（在范围内且冷却完成）
    - 实现攻击动画播放
    - _需求: 5.2, 5.5_
  
  - [x] 8.3 实现伤害计算和应用


    - 实现基础伤害公式（攻击力 - 防御力）
    - 实现伤害应用到目标生命值
    - 实现伤害数字显示（飘字效果）
    - 实现生命值条更新
    - _需求: 5.5_
  

  - [x] 8.4 实现技能系统

    - 实现技能数据加载（从MockDataService）
    - 实现技能释放条件验证（冷却、魔法值、范围）
    - 实现技能快捷键绑定（1-6数字键）
    - 实现技能效果应用（伤害、治疗等）
    - 实现技能冷却计时器
    - _需求: 5.3, 5.4, 6.1, 6.2, 6.3, 6.4, 6.5_
  
  - [x] 8.5 实现死亡处理


    - 检测生命值为零
    - 播放死亡动画
    - 移除死亡实体
    - 玩家死亡时显示复活界面
    - _需求: 5.6_

- [x] 9. 实现UI系统





  - [x] 9.1 创建UI基础框架


    - 创建UISystem类
    - 实现UI元素基类（位置、尺寸、可见性）
    - 实现UI渲染层
    - _需求: 7.1, 7.2, 7.3, 7.4_
  
  - [x] 9.2 实现生命值和魔法值条


    - 创建HealthBar组件（玩家和目标）
    - 创建ManaBar组件
    - 实现数值变化动画（平滑过渡）
    - 实现百分比显示
    - _需求: 3.5, 7.1_
  
  - [x] 9.3 实现技能栏


    - 创建SkillBar组件，显示4-6个技能图标
    - 实现技能图标绘制
    - 实现冷却遮罩动画（扇形或灰度）
    - 实现快捷键提示显示
    - 实现魔法值不足时的红色边框提示
    - _需求: 6.4, 7.2_
  
  - [x] 9.4 实现小地图


    - 创建Minimap组件
    - 绘制简化的地图视图
    - 绘制玩家位置标记（蓝点）
    - 绘制敌人位置标记（红点）
    - _需求: 3.5, 7.4_
  
  - [x] 9.5 实现消息通知系统


    - 创建NotificationSystem
    - 实现消息队列
    - 实现消息显示动画（淡入淡出）
    - 实现经验值获得、升级等通知
    - _需求: 7.5_

- [x] 10. 实现粒子特效系统









  - [x] 10.1 创建粒子系统基础


    - 创建Particle类（位置、速度、生命周期、颜色）
    - 创建ParticleSystem类，管理粒子池
    - 实现粒子更新逻辑（位置、透明度、生命周期）
    - 实现粒子渲染
    - _需求: 9.2, 9.3_
  

  - [x] 10.2 实现技能特效



    - 创建技能释放粒子效果（火球、冰锥等）
    - 创建技能命中粒子效果
    - 将粒子效果与技能系统集成
    - _需求: 6.3, 9.2_
  
  - [x] 10.3 实现战斗特效


    - 创建受击闪烁效果（精灵颜色闪烁）
    - 创建伤害数字飘字动画
    - 创建治疗特效
    - _需求: 5.5, 9.3_

- [x] 11. 实现游戏主场景GameScene

  - [x] 11.1 整合所有系统
    - 创建GameScene类
    - 初始化所有系统（渲染、战斗、移动、UI）
    - 加载地图数据和生成敌人
    - 创建玩家实体
    - _需求: 2.5, 3.2, 3.3_
  
  - [x] 11.2 实现游戏循环
    - 在update方法中调用所有系统的update
    - 在render方法中调用所有系统的render
    - 实现系统执行顺序管理
    - _需求: 3.1_
  
  - [x] 11.3 实现敌人AI（简单版）
    - 创建简单的敌人AI（被动、主动）
    - 实现敌人巡逻逻辑
    - 实现敌人追击玩家逻辑
    - 实现敌人攻击玩家逻辑
    - _需求: 5.1, 5.2_

- [ ] 12. 性能优化
  - [ ] 12.1 实现对象池
    - 创建ObjectPool类
    - 为粒子系统实现对象池
    - 为伤害数字实现对象池
    - _需求: 10.3_
  
  - [ ] 12.2 实现渲染优化
    - 实现视锥剔除（已在渲染系统中）
    - 实现静态背景离屏Canvas缓存
    - 测试并优化帧率
    - _需求: 10.1, 10.2_
  
  - [ ] 12.3 实现性能监控
    - 创建PerformanceMonitor类
    - 显示FPS、实体数量、绘制调用数
    - 实现性能数据记录
    - 添加调试模式开关
    - _需求: 10.1, 10.5_

- [ ] 13. 添加游戏资源
  - [ ] 13.1 创建占位符精灵图
    - 创建简单的角色精灵（不同职业）
    - 创建简单的敌人精灵
    - 创建技能图标
    - 创建UI元素图片
    - _需求: 3.2, 3.3, 9.1_
  
  - [ ] 13.2 添加音效（可选）
    - 添加攻击音效
    - 添加技能释放音效
    - 添加背景音乐
    - 实现音频管理器
    - _需求: 6.3, 9.2_

- [ ] 14. 错误处理和调试
  - [ ] 14.1 实现错误处理
    - 实现资源加载失败处理
    - 实现游戏逻辑异常捕获
    - 实现友好的错误提示界面
    - _需求: 1.4_
  
  - [ ] 14.2 实现日志系统
    - 创建Logger类（DEBUG、INFO、WARN、ERROR级别）
    - 在关键位置添加日志输出
    - 实现日志过滤和导出
    - _需求: 8.5_
  
  - [ ] 14.3 添加调试工具
    - 实现调试模式开关
    - 显示碰撞盒、路径、攻击范围等调试信息
    - 实现实体信息查看器
    - _需求: 8.5_

- [ ] 15. 最终整合和测试
  - [ ] 15.1 完整游戏流程测试
    - 测试从登录到游戏的完整流程
    - 测试角色创建和选择
    - 测试移动、战斗、技能释放
    - 测试UI交互
    - _需求: 所有需求_
  
  - [ ] 15.2 浏览器兼容性测试
    - 在Chrome中测试
    - 在Firefox中测试
    - 在Safari中测试（如可用）
    - 在Edge中测试
    - _需求: 1.1, 1.4_
  
  - [ ] 15.3 性能测试
    - 测试大量敌人时的性能
    - 测试长时间运行的稳定性
    - 检查内存泄漏
    - _需求: 10.1, 10.2, 10.3, 10.4, 10.5_
  
  - [ ] 15.4 创建README文档
    - 编写项目说明
    - 编写运行指南
    - 编写功能列表
    - 编写已知问题和未来计划
    - _需求: 所有需求_
